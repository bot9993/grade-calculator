<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام حساب الدرجات الأكاديمي</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --accent-color: #e74c3c;
            --light-bg: #f9f9f9;
            --dark-bg: #34495e;
            --text-color: #2c3e50;
            --light-text: #ecf0f1;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
            position: relative;
        }

        .help-icon {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            transition: var(--transition);
        }

        .help-icon:hover {
            transform: scale(1.1);
            background-color: #2980b9;
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .app-description {
            color: #777;
            font-size: 1rem;
        }

        .subject {
            margin-bottom: 30px;
            padding: 25px;
            border-radius: var(--border-radius);
            background-color: var(--light-bg);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
            border-left: 5px solid var(--primary-color);
        }

        .subject:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e1e1e1;
        }

        .subject-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .subject-icon {
            background-color: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .weeks-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .week-input {
            background-color: white;
            padding: 12px;
            border-radius: var(--border-radius);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            text-align: center;
            transition: var(--transition);
        }

        .week-input:hover {
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .week-input label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }

        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            transition: var(--transition);
        }

        input[type="text"] {
            width: 100%;
            min-width: 200px;
        }

        input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .result-container {
            background-color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result {
            font-size: 1.2rem;
            font-weight: bold;
            transition: var(--transition);
        }

        .grade-a-plus {
            color: #27ae60;
        }

        .grade-a {
            color: #2ecc71;
        }

        .grade-b {
            color: #3498db;
        }

        .grade-c {
            color: #f39c12;
        }

        .grade-d {
            color: #e67e22;
        }

        .grade-f {
            color: #e74c3c;
        }

        .grade-badge {
            background-color: #2ecc71;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            min-width: 60px;
            text-align: center;
        }

        .controls {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .btn-add {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-save {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-print {
            background-color: var(--dark-bg);
            color: white;
        }

        .btn-remove {
            background-color: #f8f9fa;
            color: var(--accent-color);
            border: 1px solid #ddd;
            padding: 8px 15px;
            font-size: 0.9rem;
        }

        .btn-remove:hover {
            background-color: #fff5f5;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            color: #777;
            font-size: 0.9rem;
        }

        .footer a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
            transition: var(--transition);
        }

        .footer a:hover {
            color: var(--secondary-color);
            text-decoration: underline;
        }

        /* زر التيليجرام */
        .telegram-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #0088cc;
            color: white;
            font-size: 1.8rem;
            margin: 30px auto;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .telegram-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .telegram-text {
            text-align: center;
            margin-bottom: 10px;
            font-weight: bold;
            color: #555;
        }

        /* مودال تعليمات الاستخدام */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            background-color: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: var(--border-radius);
            max-width: 800px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            color: #aaa;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--accent-color);
        }

        .instructions {
            margin-top: 20px;
        }

        .instructions h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .instructions ol {
            padding-right: 20px;
        }

        .instructions li {
            margin-bottom: 10px;
        }

        .instructions .tip {
            background-color: #f8f9fa;
            padding: 15px;
            border-right: 4px solid var(--secondary-color);
            margin: 15px 0;
        }

        /* تحسينات للهواتف المحمولة */
        @media print {
            button, .btn-remove, .telegram-btn, .telegram-text, .help-icon {
                display: none;
            }
            .container {
                box-shadow: none;
            }
            body {
                background-color: white;
            }
            .subject {
                break-inside: avoid;
                page-break-inside: avoid;
                box-shadow: none;
                border-left: none;
                padding: 15px 0;
            }
            .subject:hover {
                transform: none;
            }
            .week-input {
                box-shadow: none;
            }
            .result-container {
                box-shadow: none;
            }
        }

        @media (max-width: 768px) {
            .weeks-container {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            .subject-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            .controls {
                flex-direction: column;
            }
            button {
                width: 100%;
                justify-content: center;
            }
            .container {
                padding: 15px;
            }
            input[type="text"] {
                min-width: 100%;
            }
            .modal-content {
                margin: 20px;
                padding: 20px;
            }
        }

        /* تحسينات إضافية للهواتف الصغيرة */
        @media (max-width: 480px) {
            .weeks-container {
                grid-template-columns: repeat(2, 1fr);
            }
            h1 {
                font-size: 1.8rem;
            }
            .subject {
                padding: 15px;
            }
        }

        /* تحسين تجربة اللمس على الأجهزة المحمولة */
        @media (hover: none) {
            button, .telegram-btn, .help-icon {
                transition: none;
            }
            button:active, .telegram-btn:active, .help-icon:active {
                transform: scale(0.95);
            }
        }

        /* تحسين قابلية القراءة في الوضع المظلم */
        @media (prefers-color-scheme: dark) {
            .modal-content, .week-input, .result-container {
                background-color: #f9f9f9;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>نظام حساب الدرجات الأكاديمي</h1>
            <p class="app-description">نظام متكامل لحساب وتتبع الدرجات على مدار 12 أسبوع دراسي</p>
            <div class="help-icon" onclick="openInstructions()">
                <i class="fas fa-question"></i>
            </div>
        </header>
        
        <div id="subjects-container">
            <!-- المواد ستضاف هنا ديناميكياً -->
        </div>

        <div class="controls">
            <button onclick="addSubject()" class="btn-add">
                <i class="fas fa-plus"></i> إضافة مادة جديدة
            </button>
            <button onclick="saveAllGrades()" class="btn-save">
                <i class="fas fa-save"></i> حفظ جميع الدرجات
            </button>
            <button onclick="window.print()" class="btn-print">
                <i class="fas fa-print"></i> طباعة النتائج
            </button>
        </div>

        <!-- زر التيليجرام -->
        <div class="telegram-text"> للاستفسارات تواصل معنا عبر تيليجرام</div>
        <div class="telegram-btn" onclick="contactOnTelegram()">
            <i class="fab fa-telegram-plane"></i>
        </div>

        <div class="footer">
            © 2025 نظام حساب الدرجات الأكاديمي ميدأوشن - جميع الحقوق محفوظة 
            <br>
         للتواصل مع المطور <a href="https://t.me/M7_JA" target="_blank">@M7_JA</a>
        </div>
    </div>

    <!-- مودال تعليمات الاستخدام -->
    <div id="instructionsModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeInstructions()">&times;</span>
            <h2>تعليمات استخدام نظام حساب الدرجات</h2>
            
            <div class="instructions">
                <h3>كيفية استخدام النظام</h3>
                <ol>
                    <li><strong>إضافة مادة:</strong> انقر على زر "إضافة مادة جديدة" لإضافة مادة دراسية.</li>
                    <li><strong>تسمية المادة:</strong> أدخل اسم المادة في الحقل المخصص.</li>
                    <li><strong>إدخال الدرجات:</strong> لكل أسبوع، أدخل الدرجة من 0 إلى 8.</li>
                    <li><strong>حساب الدرجة:</strong> سيتم حساب الدرجة النهائية تلقائياً (من أصل 100).</li>
                    <li><strong>حفظ البيانات:</strong> انقر على زر "حفظ جميع الدرجات" لحفظ بياناتك.</li>
                    <li><strong>طباعة النتائج:</strong> انقر على زر "طباعة النتائج" لطباعة جميع الدرجات.</li>
                </ol>

                <div class="tip">
                    <strong>نصيحة:</strong> يتم حفظ البيانات محلياً على جهازك، لذا لا تقم بمسح بيانات المتصفح إذا كنت ترغب في الاحتفاظ بالدرجات.
                </div>

                <div class="tip">
                    <strongللاستفسارات:</strong> للاستفسارات تواصل معنا على تيليجرام <a href="https://t.me/M7_JA" target="_blank">@M7_JA</a>
                </div>

                <h3>كيفية حساب الدرجات</h3>
                <ul>
                    <li>الدرجة الكاملة هي 100 درجة.</li>
                    <li>كل أسبوع له 8 درجات كحد أقصى.</li>
                    <li>يتم خصم الدرجات المفقودة من الدرجة الكاملة.</li>
                    <li>التقديرات تكون كالتالي:
                        <ul>
                            <li>A+ : 95 درجة فأعلى</li>
                            <li>A : 90 إلى 94 درجة</li>
                            <li>B+ : 85 إلى 89 درجة</li>
                            <li>B : 80 إلى 84 درجة</li>
                            <li>C+ : 75 إلى 79 درجة</li>
                            <li>C : 70 إلى 74 درجة</li>
                            <li>D+ : 65 إلى 69 درجة</li>
                            <li>D : 60 إلى 64 درجة</li>
                            <li>F : أقل من 60 درجة</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let subjectCount = 0;

        // تحميل البيانات المحفوظة عند تحميل الصفحة
        window.onload = function() {
            loadSavedGrades();
        };

        function createWeekInputs(subjectId) {
            let html = '<div class="weeks-container">';
            for (let week = 1; week <= 12; week++) {
                html += `
                    <div class="week-input">
                        <label for="${subjectId}-week${week}">الأسبوع ${week}</label>
                        <input type="number" 
                               max="8" 
                               min="0" 
                               id="${subjectId}-week${week}"
                               onchange="calculateGrade('${subjectId}')"
                               placeholder="0-8">
                    </div>`;
            }
            html += '</div>';
            return html;
        }

        function addSubject() {
            subjectCount++;
            const subjectId = `subject${subjectCount}`;
            
            const subjectDiv = document.createElement('div');
            subjectDiv.className = 'subject';
            subjectDiv.id = subjectId + '-container';
            
            subjectDiv.innerHTML = `
                <div class="subject-header">
                    <div class="subject-title">
                        <div class="subject-icon">${subjectCount}</div>
                        <h3>المادة ${subjectCount}</h3>
                    </div>
                    <div>
                        <input type="text" 
                               placeholder="اسم المادة" 
                               id="${subjectId}-name">
                        <button onclick="removeSubject('${subjectId}-container')" class="btn-remove">
                            <i class="fas fa-trash-alt"></i> حذف المادة
                        </button>
                    </div>
                </div>
                ${createWeekInputs(subjectId)}
                <div class="result-container">
                    <div class="result" id="${subjectId}-result">الدرجة النهائية: 100</div>
                    <div class="grade-badge" id="${subjectId}-grade">A+</div>
                </div>
            `;
            
            document.getElementById('subjects-container').appendChild(subjectDiv);
            calculateGrade(subjectId); // حساب الدرجة الأولية
        }

        function removeSubject(containerId) {
            const element = document.getElementById(containerId);
            if (element) {
                element.remove();
            }
        }

        function calculateGrade(subjectId) {
            let totalDeduction = 0;
            let finalGrade = 100;
            
            // حساب مجموع الدرجات المفقودة
            for (let week = 1; week <= 12; week++) {
                const weekGradeElement = document.getElementById(`${subjectId}-week${week}`);
                const weekGrade = weekGradeElement ? weekGradeElement.value : '';
                
                if (weekGrade !== '') {
                    const maxWeekGrade = 8;
                    const deduction = maxWeekGrade - parseInt(weekGrade);
                    totalDeduction += deduction;
                }
            }
            
            finalGrade -= totalDeduction;
            finalGrade = Math.max(0, finalGrade); // لا يمكن أن تكون الدرجة أقل من صفر
            
            const resultElement = document.getElementById(`${subjectId}-result`);
            const gradeElement = document.getElementById(`${subjectId}-grade`);
            
            // تعيين النص والتقدير
            resultElement.textContent = `الدرجة النهائية: ${finalGrade}`;
            
            // تعيين اللون والتقدير حسب الدرجة
            resultElement.className = 'result';
            gradeElement.textContent = getGradeLetter(finalGrade);
            
            // تعيين لون الدرجة حسب القيمة
            if (finalGrade >= 95) {
                resultElement.classList.add('grade-a-plus');
                gradeElement.style.backgroundColor = '#27ae60';
            } else if (finalGrade >= 90) {
                resultElement.classList.add('grade-a');
                gradeElement.style.backgroundColor = '#2ecc71';
            } else if (finalGrade >= 80) {
                resultElement.classList.add('grade-b');
                gradeElement.style.backgroundColor = '#3498db';
            } else if (finalGrade >= 70) {
                resultElement.classList.add('grade-c');
                gradeElement.style.backgroundColor = '#f39c12';
            } else if (finalGrade >= 60) {
                resultElement.classList.add('grade-d');
                gradeElement.style.backgroundColor = '#e67e22';
            } else {
                resultElement.classList.add('grade-f');
                gradeElement.style.backgroundColor = '#e74c3c';
            }
            
            return finalGrade;
        }

        function getGradeLetter(grade) {
            if (grade >= 95) return 'A+';
            if (grade >= 90) return 'A';
            if (grade >= 85) return 'B+';
            if (grade >= 80) return 'B';
            if (grade >= 75) return 'C+';
            if (grade >= 70) return 'C';
            if (grade >= 65) return 'D+';
            if (grade >= 60) return 'D';
            return 'F';
        }

        function saveAllGrades() {
            const grades = {};
            let hasSubjects = false;
            
            for (let i = 1; i <= subjectCount; i++) {
                const subjectId = `subject${i}`;
                const subjectContainer = document.getElementById(`${subjectId}-container`);
                
                // تخطي المواد المحذوفة
                if (!subjectContainer) continue;
                
                hasSubjects = true;
                const subjectName = document.getElementById(`${subjectId}-name`).value || `المادة ${i}`;
                
                const weekGrades = {};
                for (let week = 1; week <= 12; week++) {
                    const gradeElement = document.getElementById(`${subjectId}-week${week}`);
                    weekGrades[`week${week}`] = gradeElement.value;
                }
                
                const finalGrade = calculateGrade(subjectId);
                grades[subjectName] = {
                    weekGrades: weekGrades,
                    finalGrade: finalGrade,
                    gradeLetter: getGradeLetter(finalGrade)
                };
            }
            
            if (!hasSubjects) {
                showNotification('لا توجد مواد لحفظها!', 'error');
                return;
            }
            
            // حفظ البيانات في localStorage
            localStorage.setItem('gradesData', JSON.stringify(grades));
            showNotification('تم حفظ جميع الدرجات بنجاح!', 'success');
        }

        function showNotification(message, type) {
            // إنشاء عنصر الإشعار
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.right = '20px';
            notification.style.padding = '15px 25px';
            notification.style.borderRadius = '5px';
            notification.style.color = 'white';
            notification.style.fontWeight = 'bold';
            notification.style.zIndex = '1000';
            notification.style.boxShadow = '0 3px 10px rgba(0,0,0,0.2)';
            
            if (type === 'success') {
                notification.style.backgroundColor = '#2ecc71';
            } else if (type === 'error') {
                notification.style.backgroundColor = '#e74c3c';
            }
            
            document.body.appendChild(notification);
            
            // إزالة الإشعار بعد 3 ثوانٍ
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.5s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }

        function loadSavedGrades() {
            const savedGrades = localStorage.getItem('gradesData');
            if (savedGrades) {
                const grades = JSON.parse(savedGrades);
                
                // إضافة المواد المحفوظة
                Object.keys(grades).forEach((subjectName, index) => {
                    addSubject();
                    const subjectId = `subject${subjectCount}`;
                    
                    // تعيين اسم المادة
                    document.getElementById(`${subjectId}-name`).value = subjectName;
                    
                    // تعيين درجات الأسابيع
                    const weekGrades = grades[subjectName].weekGrades;
                    Object.keys(weekGrades).forEach(week => {
                        const weekNumber = week.replace('week', '');
                        const element = document.getElementById(`${subjectId}-week${weekNumber}`);
                        if (element && weekGrades[week]) {
                            element.value = weekGrades[week];
                        }
                    });
                    
                    // إعادة حساب الدرجة النهائية
                    calculateGrade(subjectId);
                });
            } else {
                // إضافة مادة واحدة افتراضية إذا لم تكن هناك بيانات محفوظة
                addSubject();
            }
        }

        // فتح وإغلاق مودال التعليمات
        function openInstructions() {
            document.getElementById('instructionsModal').style.display = 'block';
        }

        function closeInstructions() {
            document.getElementById('instructionsModal').style.display = 'none';
        }

        // إغلاق المودال عند النقر خارجه
        window.onclick = function(event) {
            const modal = document.getElementById('instructionsModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        // فتح تيليجرام للتواصل
        function contactOnTelegram() {
            window.open('https://t.me/M7_JA', '_blank');
        }
    </script>
</body>
</html>
